<!DOCTYPE html>
<Html>

<head>
    <title>Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    {%load static%}
    <Style>#profile-img {
    padding-top: 10px;
    height: 230px;
}

#profile-name {
    padding-left: 80px;
    font-size: 40px;
}

#profile-card {
    margin-left: 30%;
    margin-right: 50%;
}


.container {
    display: flex;
}

.navi {
    /* display: block; */
    background-color: #DFE6ED;
    height: 70px;
    width: 100%;

}

.title {
    display: block;
    margin: auto;
}

.file {
    display: inline;
}

.sidenav {
    height: 490px;
    width: auto;
    z-index: 1;
    top: 10;
    left: 0;
    background-color: #DFE6ED;
    padding-top: 3%;
}

.sidenav button {
    margin: auto;
    margin-left: 0px;
    margin-right: auto;
    width: 125px;
    padding: 8px 8px 8px 8px;
    margin-bottom: 20px;
    text-decoration: none;
    display: block;
    transition: 0.3s;
    background-color: white;
    color: #6558F5;
}

.content {
    padding-top: 20px;
}

.form-control {
    margin-top: 30px;
}

body {
    overflow-x: hidden;
    /* Hide scrollbars */
    line-height: 1.5;
    font-size: 0.875rem;
    font-family: var(--ff-secondary);
}

#add-points {
    background-color: #8DD7CF;
}

#submit-button {
    background-color: #F3C19D;
}

form {
    display: none;
}


.card {
    margin-bottom: 2%;

}

.row.points {
    margin-top: 4%;
    padding-top: 10px;
    padding-bottom: 10px;
    width: 100%;
    background-color: #8DD7CF;
    border-color: #67dfd3;
}

.row.points h6 {
    display: inline;
    text-align: center;
}

.file-image {
    height: 80px;
    width: 80px;
}

.box1 {
    float: left;
    margin-left: 10px;
}

#Points {
    text-align: center;
    color: black;
    padding-top: 13%;
    padding-bottom: 13%;
}

#Profile,
#Task,
#Points {
    display: none;
}

.close-overflow {
    overflow: hidden;
}

.close-horoverflow {
    overflow-y: scroll;
    overflow-x: hidden;
}

.screenshot {
    height: 300px;
    background-color: white;
}

@media (min-width:1200px) {
    .screenshot h6 {
        padding-top: 40px;
        padding-left: 200px;
    }

    #ssimg {
        height: 150px;
        width: auto;
        margin-top: 75px;
        margin-left: 280px;
    }
}

@media(max-width:1200px) {
    .screenshot h6 {
        padding-top: 100px;
        padding-left: 50px;
    }

    #ssimg {
        height: 80px;
        width: auto;
        margin-top: 85px;
        margin-left: 140px;
    }
}

@media(max-width:600px) {
    .screenshot h6 {
        padding-top: 60px;
        padding-left: 20px;
    }

    #ssimg {
        height: 80px;
        width: auto;
        margin-top: 85px;
        margin-left: 50px;
    }

}


#view-detail {
    display: none;
}

/* .home {
    display: none;
} */

.show {
    display: block;
}

.hide {
    display: none;
}

#drop_zone {
    border: 5px solid blue;
    width: 200px;
    height: 100px;
}

.drop-zone {
    max-width: 200px;
    height: 300px;
    padding: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    font-family: "Quicksand", sans-serif;
    font-weight: 500;
    font-size: 20px;
    cursor: pointer;
    color: #cccccc;
    border: 4px dashed #8DD7CF;
    border-radius: 10px;
}

.drop-zone--over {
    border-style: solid;
}

.drop-zone__input {
    display: none;
}

.drop-zone__thumb {
    width: 100%;
    height: 100%;
    border-radius: 10px;
    overflow: hidden;
    background-color: #cccccc;
    background-size: cover;
    position: relative;
}

.drop-zone__thumb::after {
    content: attr(data-label);
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    padding: 5px 0;
    color: #ffffff;
    background: rgba(0, 0, 0, 0.75);
    font-size: 14px;
    text-align: center;
}</Style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>

<body>
    <div class="container-12">
        <div class="row">
            <nav class="navbar navbar-expand-lg ">
                <h1 class="title">Hello Admin</h1>
            </nav>
        </div>
        <div class="row">
            <div class="navi">
            </div>
        </div>
        <div class="row">
            <div class="col-5 col-lg-3">
                <div class="sidenav ">
                    <ul class="sidebar">
                        <Button class="btn btn-primary side-item active Home" id="home" type="button"><i
                                class="bi bi-house-door-fill"></i>
                            Home</Button>
                        <Button class="btn btn-primary side-item" id="AddApp" type="button"><i
                                class="bi bi-plus-lg"></i> Add
                            Apps</Button>
                        <Button class="btn btn-primary side-item logout" type="button"><i class="fa-solid fa-power-off"></i>
                                Logout</Button>
                    </ul>
                </div>
            </div>
            <div class="col-7 col-lg-8 content">
                <!-- Home Page STARTS -->
                <div class="home Home">

                </div>
                <!-- HOME PAGE END -->
                <!-- ADD APPS PAGE -->
                <form id="form">
                    <div class="row">
                        <!-- image -->
                        <input class="form-control file-upload-input" type="file" 
                            accept="Image/*">
                    </div>
                    <div class="row">
                        <div class="col">
                            <!-- app name -->
                            <input class="form-control app-name" type="text" placeholder="App Name">
                        </div>
                        <div class="col">
                            <!-- applink -->
                            <input class="form-control" type="text" placeholder="App Link">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <!-- app category dropdown -->
                            <select class="form-control app-category">
                                <option disabled selected>App Category</option>
                                <option>Entertainment</option>
                                <option>Games</option>
                                <option>E-commerce</option>
                            </select>
                        </div>
                        <div class="col">
                            <!-- sub category -->
                            <select class="form-control app-sub-category" >
                                <option disabled selected>Sub Category</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <!-- ADD POINTS BUTTON -->
                        <div class="col-3"></div>
                        <div class="col-6 ">
                            <button type="button" class="form-control" id="add-points">ADD POINTS</button>
                        </div>
                        <div class="col-3"></div>
                    </div>
                    <div class="row">
                        <!-- submit button -->
                        <div class="col-3"></div>
                        <div class="col-6 ">
                            <button type="submit" class="form-control" id="submit-button">SUBMIT</button>
                        </div>
                        <div class="col-3"></div>
                    </div>
                </form>

                <!-- ADD APPS PAGE END -->
            </div>
            <div class="col-1 col-lg-1">
            </div>
        </div>
    </div>
</body>
<script>
console.log("hi");
const home = document.querySelector("#home");
const app = document.querySelector("#AddApp");
const form = document.querySelector("form");
const file = document.querySelector(".home");
app.addEventListener("click", () => {
    form.style.display = "block";
    file.style.display = "none";
})
home.addEventListener("click", () => {
    file.style.display = "block";
    form.style.display = "none";
})
const subcat = {
    "entertainment": ["Social Media", "OTT"],
    "games": ["Adventure", "Action"],
    "ecommerce": ["Clothing", "Grocery"],
}

const category = document.querySelector(".app-category");
const subcategory = document.querySelector(".app-sub-category");

category.addEventListener("change", () => {
    console.log(subcat["entertainment"]);
    let change = `<option disabled selected>Sub Category</option>`;
    if (category.value == "Entertainment") {
        subcat["entertainment"].forEach(element => {
            change += `<option>${element}</option>`;
        });
    }
    if (category.value == "Games") {
        subcat["games"].forEach(element => {
            change += `<option>${element}</option>`;
        });
    }
    if (category.value == "E-commerce") {
        subcat["ecommerce"].forEach(element => {
            change += `<option>${element}</option>`;
        });
    }
    subcategory.innerHTML = change;
})

let points = 0;
const addpoints = document.querySelector("#add-points");
addpoints.addEventListener("click", () => {
    addpoints.innerHTML = points;
    points += 10;
})

const appname = document.querySelector(".app-name");
const application = document.querySelector("#form");


application.addEventListener("submit", (e) => {
    e.preventDefault();
    console.log("hello");
    const addfile = {
        "file": null,
        "name": appname.value,
        "points": points - 10,
    };
    fetch("http://127.0.0.1:8000/api/saveapp", {
        method: "POST",
        body: JSON.stringify(addfile),
        headers: {
            "Content-type": "application/json",
            'X-CSRFToken': csrfToken,
        }
    }).then(response => response.json()).then(json => console.log(json));
    const field = document.querySelectorAll("form input");
    field.forEach((fil) => {
        fil.value = "";
    })
    points = 0;
    addpoints.innerHTML = "Add Points";
    category.innerHTML = `  <option disabled selected>App Category</option>
                            <option>Entertainment</option>
                            <option>Games</option>
                            <option>E-commerce</option>`;
    subcategory.innerHTML = `<option disabled selected>Sub Category</option>`;
})




    </script>
<script >
        const btns = document.querySelectorAll(".side-item");
document.addEventListener("DOMContentLoaded", () => {
    btns.forEach(btn => {
        btn.addEventListener("click", () => {
            btns.forEach((btn1) => {
                if (btn1 != btn) {
                    btn1.classList.remove("active");
                }
            })
            btn.classList.add("active");
            document.body.classList.remove('close-overflow');
            document.body.classList.remove('close-horoverflow');
            if (btn.classList.contains("Home") || btn.classList.contains("Task")) {
                document.body.classList.add("close-horoverflow");
            }
            else {
                document.body.classList.add("close-overflow");
            }
        })
    })
    var nav = document.querySelector(".sidenav");
    var body = document.body;
    var html = document.documentElement;
    var height = Math.max(body.scrollHeight, body.offsetHeight,
        html.clientHeight, html.scrollHeight, html.offsetHeight);
    nav.style.height = height + "px";
})

const files = document.querySelector(".home");

appret();
async function appret() {
    let link = new URL(`https://mydjangosite.onrender.com/api/allapps`);
    const response = await fetch(link);
    const data = await response.json();
    displayitems(data);
}

function displayitems(data) {
    let displayMenu = data.map(function (item) {

        return `<div class="card file" style="background-color: #DFE6ED">
        <div class="card-body">
            <div class="row">
                <div class="col">
                    <div class="col box1">
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAclBMVEX///8AAABCQkL7+/v39/dPT0+mpqbGxsbs7OwXFxe2trbJycl3d3fU1NQvLy+jo6M7OzuPj4/j4+NJSUmFhYVvb29VVVVbW1tnZ2fX19dgYGDg4OAgICA8PDxiYmKTk5MoKCh+fn68vLwLCwucnJySkpJeWSrHAAAErUlEQVR4nO3d63KiQBSFURAiFyUqERM1idHJvP8rzkQdoa1Aw4HeRzP7+03RrECkikvjeYwxxhhjjLFbK87SsdMOWajpyzavvvNei7WWL1i4552a6uzHoEABfX+lQpzigL7/rEAcI4F/92KMBoZzrBB/oEb/Bk4jlz2WRPSBev4dnQZuh3nz1YinH9LE8X9HYPwvQA/UYHUcc+54TFMIJQYPxyFHGGGicKBihQ9LPBErfPLwRLQQT4QLS+IGQ8QL0XtRQQgmagixB6qKEErUESIPVCUhkKglLInvrofWEsL+F/WEKKKiEHSgagpL4ovDKwyqQshe1BVWiM72orIQcKBqCytER5ugLnRO1Be6PlBvQFgSCxfEWxC6PVBvQuj0QL0NocsDFST0TsN81A7jjogSnu+kL2sXuDxLMPSBWiPMZp+z1n3OJtatSv9t/6zucZTLvZspQNj92QXrtYj4V/uVpe6Fglv7O9tAv9uv623Qf5lvhavuwifbcRo+tF/ZxLnwvbtwZR0pH7Ve2cK5MLJswTeN7UOFL21XVjgXerOPbr6k3V99UrRb72rIE0bN2SLMOtX6OYd4O2kqOt8qBgiVCkY/XRhSKIhCbBRKohAbhZIoxEahJAqxUSiJQmwUSqIQG06YL0b1vT3tqlee8uVo3rB0U/PRItcR5raLfqOSuO33fu2HQYQJl03bdKy8ALzvBby63wYT2q+/l3fA+r6+OFIRdtmHfd+x1dmHW9vNvsfy/3DdD5hsVYTedvrY0HxZ/XlYF03LWpoaQJ4PRVGIjUJJFGKjUBKF2CiURCE2CiVRiI1CSf+rMEinRTF13d8hUtMCE4ZPPqqrgVHCTxjQ9z9VhLhdePUaDUwInEjRfOIZJsyAwkxF6EWrBNMqMsYFng+DGNMVhWd8SRRio1AShdgolEQhNgolUYiNQkkUYqNQ0hDzYlxPkmGsaT1uWjozh4UJg36P4xWVldkeAjTn84cJ+37yYnZZk33uAmOqApiwwxQW31Y+M7q3LvugIhTMi2H0fFmT/Rs97ypCwbwYRuUEM/anT43Libjf0q7zYhi9Vm9FpI+Ny37MjHGBZ4tw3W1ijErruP2a1tfD8owviEJsFEqiEBuFkijERqEkCrFRKIlCbBRKqhHGkyiKGidx7N/XCFdTSuKEuw6z/vbqlzk7L0x4APm+OqgIn4HC5+rAMKFgpmRxxgTEMGHatEkDZ0zejbszs4cB9zp3Zjxve0gRHcwJB3jGF0UhNgolUYiNQkkUYqNQEoXYKJREITYKJbkX5tu8vh/whmXU/F74m/mNtTsUbht9XxlPFN+hcGcVvlQXv0Ph3irUmXFguOz3B4zHL+9QaP1WpPlpyDsUet5kt6jv90Fp9ha1KJREITYKJVGIjUJJFGKjUBKF2CiURCE2CiUFp6f05jciPH15aNCvx5/nuUxy+5KA8uS4NYV9yQ6d3ycfdqXSztetFoOudHJaqb9JI+3SzXlbJvbN7lDY96Nbwzf0j0LfSTCGb2zf6G4h59Rt0/A/Cdbr0tiKQU8V5+zzc+Aa9nf0UrZJtGXHkk1m31hhcZaOtUuz2L6hjDHGGGOMMXB/AFbjgPStNOjZAAAAAElFTkSuQmCC" alt="" class="file-image">
                    </div>
                    <div class="col box1">
                        <h4>${item.name}</h4>
                        <a href="#" >
                            <input type=button value="View-in-detail" class="View-in-detail" onclick="myfunction(${item.id})"/>
                        </a>
                    </div>
                </div>
                <div class="col">
                    <div class="row points">
                        <h6>${item.points} Points</h6>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>`
    })
    displayMenu = displayMenu.join("");
    files.innerHTML = displayMenu;
}
const home3 = document.querySelector(".home");
const detail3 = document.querySelector('#view-detail');
const detailTitle = document.querySelector('#detail-title');
const detailPoints = document.querySelector('#detail-points');
const dropzone = document.querySelector("#dropzone");
console.log(dropzone);
const csrfToken = document.cookie.replace(/(?:(?:^|.*;\s*)csrftoken\s*=\s*([^;]*).*$)|^.*$/, "$1");
function myfunction(id) {
    getapp()

    async function getapp() {
        let link3 = new URL(`https://mydjangosite.onrender.com/api/getapp/${id}`);
        const response3 = await fetch(link3);
        const data3 = await response3.json();
        console.log(data3);
        detailTitle.textContent = data3.name;
        detailPoints.textContent = data3.points + " Points";
        home3.style.display = "none";
        detail3.style.display = "block";
        localStorage.setItem('appname', data3.name);
        localStorage.setItem('apppoints', data3.points);
        dropzone.addEventListener("change", () => {
            const addfile1 = {
                "file": null,
                "name": data3.name,
                "points": data3.points,
                "complete": false,
            };
            saveapp();
            async function saveapp() {
                fetch("https://mydjangosite.onrender.com/api/saveapp", {
                    method: "POST",
                    body: JSON.stringify(addfile1),
                    headers: {
                        "Content-type": "application/json",
                        'X-CSRFToken': csrfToken,
                    }
                }).then(response => response.json()).then(json => alert("Screenshot Saved"));
            }
        })
    }
}

const homebtn = document.querySelector(".Home");
homebtn.addEventListener("click", () => {
    home3.style.display = "block";
})

//fetch get
const logoutbtn = document.querySelector(".logout");
logoutbtn.addEventListener("click", () => {
    fetch("https://mydjangosite.onrender.com/api/logout").then(response => response.json()).then(json => console.log(json));
    alert("Logout Successful");
    window.location.href = "https://mydjangosite.onrender.com/users/user";
})
    </script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
    crossorigin="anonymous"></script>

</Html>
